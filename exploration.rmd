---
title: "CHIC601 Group Project"
author: greyhypotheses
date: 30/11/2021
output: pdf_document
---



<!--- global Settings --->
```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

<!--- libraries --->
```{r include = FALSE}
library(dplyr)
library(ggplot2)
library(stringr)
library(latex2exp)
library(tidyr)
```


<!--- External Functions
The set of [custom] external functions used by this document.
--->
```{r include = FALSE}
sys.source(file = 'R/functions/SurveyData.R', envir = knitr::knit_global())
sys.source(file = 'R/functions/FrequenciesTable.R', envir = knitr::knit_global())

sys.source(file = 'R/functions/ExploreDayMethod.R', envir = knitr::knit_global())
sys.source(file = 'R/functions/ExploreAgeSex.R', envir = knitr::knit_global())
sys.source(file = 'R/functions/ExploreAgeMethod.R', envir = knitr::knit_global())
```


# Exploratory Data Analysis

After inspecting/preparing Social Contact Survey data, in-line with Dr. Read's data preparation suggestions, the outline is

\small
```{r  comment = '         '}
# Reading-in the inspected/prepared survey data
survey <- SurveyData()

# The description
str(survey, vec.len = 3)
```
\normalsize

\pagebreak

## The Variables

### Age Groups & Survey Method

Disaggregation of responses by survey method

\small
```{r}
T <- FrequenciesTable(field = survey$method, fieldname = 'method')
knitr::kable(x = T, caption = 'The number of survey reponses per survey method')
```
\normalsize

The age groups, based on the *age* field. [ref. SurveyData() function]
```{r out.width = '50%', fig.align = 'center', fig.cap = 'The distribution of age groups'}
barplot(table(survey$agegroup), col = 'black', las = 2,
        xlab = '\n', ylab = 'count\n', main = 'Age Groups')
```

\vspace{10pt}

```{r out.width = '65%', fig.align = 'center', fig.cap = 'Age group and survey method'}
MixedGraphAgeMethod(survey = survey)
```

\vspace{10pt}


\pagebreak

### Day of Week & Survey Method

```{r out.width = '40%', fig.align = 'center', fig.cap = 'The distribution of responses by day of week'}
barplot(table(survey$day_of_week), col = 'black', las = 2,
        xlab = '\n', ylab = 'count\n', main = 'Day of Week')
```

\vspace{10pt}

```{r out.width = '55%', fig.align = 'center', fig.cap = 'The distribution of responses by day of week and survey method'}
GraphDayMethod(survey = survey)
```



\pagebreak

### Occupations

```{r out.width = '55%', fig.align = 'center', fig.cap = 'The distribution of occupations'}
barplot(table(survey$occupation), col = 'black', las = 2,
        xlab = '\n', ylab = 'count\n', main = 'Occupations')
```



\pagebreak

### Age Group & Sex

```{r}
knitr::kable(x = FrequenciesTable(field = survey$sex, fieldname = 'sex'),
             caption = 'The sex distribution')
```

```{r out.width = '55%', fig.align = 'center', fig.cap = 'Age group and sex'}
GraphAgeSex(survey = survey)
```




## Tests

```{r}
library(data.table)
library(MASS)
library(equatiomatic)
```

Data
```{r}
source(file = 'R/modelling/WithPlacesData.R')
source(file = 'R/modelling/WithPlacesGraphs.R')

# modelling & analysis data
focus <- WithPlacesData()
```


Modelling
```{r}


modelglmnb <- glm.nb(formula = total_contacts ~ agegroup + ru11ind + occupation + household_size + sex, data = focus)
modelglmnbstep <- step(modelglmnb, trace = 0)
summary(modelglmnbstep)
```

And

```{r echo = TRUE}
equatiomatic::extract_eq(model = modelglmnbstep, wrap = TRUE)
```

